{% extends 'nav.html' %}

{% block title %}Update Profile{% endblock %}

{% block content %}
<style>
  /* General Styling */
  
  .container {
            max-width: 600px;
            margin: 50px auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

  .container h2 {
    text-align: center;
    margin-top: 12px;
    margin-bottom: 5px; /* Reduced spacing */
    font-size: 20px; /* Compact font size */
    color: #333;
  }

  .form-group {
    margin-bottom: 10px; /* Reduced spacing */
  }

  .form-group label {
    font-weight: bold;
    color: #555;
    margin-bottom: 4px; /* Compact spacing */
    display: block;
    font-size: 14px;
  }

  .form-group input,
  .form-group textarea,
  .form-group select {
    width: 100%;
    padding: 8px; /* Reduced padding */
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
  }

  .form-group textarea {
    height: 50px; /* Smaller text area height */
  }

  .form-group input[type="file"] {
    padding: 2px; /* Compact padding */
  }

  .form-group .radio-group {
    display: flex;
    gap: 8px; /* Reduced spacing */
  }

  .form-group .radio-group label {
    display: flex;
    align-items: center;
    gap: 3px; /* Reduced gap */
    font-size: 14px;
  }

  .btn {
    display: block;
    width: 100%;
    padding: 10px; /* Compact padding */
    background: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    cursor: pointer;
    margin-top: 10px; /* Reduced margin */
  }

  .btn:hover {
    background: #0056b3;
  }

  .profile-image {
    display: flex;
    justify-content: center;
    margin-bottom: 10px; /* Reduced margin */
  }

  .profile-image img {
    width: 100px; /* Smaller image size */
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid #ddd;
  }

  
  .text-success {
        color: green;
        font-weight: bold;
    }
    .text-danger {
        color: red;
        font-weight: bold;
    }
    

</style>

  
<div class="container">
  <h2>Update Profile</h2>
  {% if messages %}
    <div class="alert-container">
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    </div>
{% endif %}



  <form method="POST" action="{% url 'edit_profile' %}" enctype="multipart/form-data">
    {% csrf_token %}

    <!-- Profile Image -->
    <div class="profile-image">
      <img src="{{ patient.image.url }}" alt="Profile Image" onerror="this.src='/static/images/default-profile.png';">
    </div>

    <!-- First Name -->
    <div class="form-group">
      <label for="first_name">First Name</label>
      <input type="text" id="first_name" name="first_name" value="{{ patient.user.first_name }}" required>
    </div>

    <!-- Last Name -->
    <div class="form-group">
      <label for="last_name">Last Name</label>
      <input type="text" id="last_name" name="last_name" value="{{ patient.user.last_name }}" required>
    </div>
    <div class="form-group">
      <label for="username" class="form-label">Username</label>
      <input type="text" class="form-control" id="username" name="username" value="{{ patient.user.username }}" required>
  </div>
    <div class="form-group">
      <label for="email" class="form-label">Email Address</label>
      <input type="email" class="form-control" id="email" name="email" value="{{  patient.user.email }}" required>
      <small id="emailError" class="text-danger"></small>
  </div>

    <!-- Address -->
    <div class="form-group">
      <label for="address">Address</label>
      <textarea id="address" name="address" rows="3" required>{{ patient.address }}</textarea>
    </div>

    <!-- Age -->
    <div class="form-group">
      <label for="age">Age</label>
      <input type="number" id="age" name="age" value="{{ patient.age }}" required>
    </div>

    <!-- Gender -->
    <div class="form-group">
      <label>Gender</label>
      <div class="radio-group">
        <label>
          <input type="radio" name="gender" value="male" {% if patient.Gender == "male" %}checked{% endif %}> Male
        </label>
        <label>
          <input type="radio" name="gender" value="female" {% if patient.Gender == "female" %}checked{% endif %}> Female
        </label>
        <label>
              
          <input type="radio" name="gender" value="other" {% if patient.Gender == "other" %}checked{% endif %}> Other
        </label>
      </div>
    </div>

    <!-- Contact -->
    <div class="form-group">
      <label for="contact">Contact</label>
      <input type="tel" id="phone" name="contact" value="{{ patient.contact }}" required>
      <small id="phoneError" class="text-danger"></small>
    </div>

    <!-- Profile Image Input -->
    <div class="form-group">
      <label for="image">Profile Image</label>
      <input type="file" id="image" name="image">
    </div>

    <!-- Submit Button -->
    <button type="submit" class="btn">Save Changes</button>
  </form>
</div>
<script>
  email = document.getElementById("email"); 
  mobileinput = document.getElementById("phone"); 

  mobileinput.addEventListener("input", validatePhoneNumber); 

  email.addEventListener("input",validateEmail); 
  function validatePhoneNumber(){ 
      phonePattern = /^[0-9]{0,10}$/; 
      if(!phonePattern.test(mobileinput.value)){ 
          phoneError.textContent ="only digitss are allowed"; 
          return; 

      } 
      if(mobileinput.value.length<10){ 
          phoneError.textContent="mobile number must 10 digits"; 

      } 
      else{ 
          phoneError.textContent =""; 


      } 
  } 
      function validateEmail(){ 
          emailError = document.getElementById("emailError"); 
          emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; 
          if(!emailPattern.test(email.value)){ 
              emailError.textContent="please enter valid email address"; 

          } 
          else{ 
              emailError.textContent=""; 

           
      } 
  } 
</script>

{% endblock %}